---
layout: page
title: Add a Log Drain to your App
nav: Log Drain
modified_at: 2020-05-22 00:00:00
tags: Papertrail Logentries Logmatic Graylog logs integration
---

## Integration Purposes

Using a log management solution to gather the logs from applications and
containers eases the work when trying to find an information.
A few SaaS solutions exist such as Logentries, Logmatic.io, Papertrail or
Graylog.
You can also host such solution on Scalingo. Here is a tutorial on
[how to deploy the ELK
stack](https://scalingo.com/articles/2018/02/23/running-the-elk-stack-on-scalingo.html)
on the platform.

Scalingo support sending applications logs using the standard
syslog protocol over UDP, TCP or TCP+TLS.

## Third-party Provider integrations

Our system is also able to send logs to the following SaaS log processing providers:

* Scalingo hosted ELK stack ([how to setup]({% post_url platform/getting-started/2000-01-01-getting-started-with-elk %}))
* Datadog
* Logentries
* Graylog
* Papertrail
* Syslog

## Configuration of your Application on Scalingo

The log drains configuration will be done using the [CLI
](https://doc.scalingo.com/cli).

### Add a Log Drain

To add a log drain management service you will have to use the `log-drains-add`
command.
Below, the list of available parameters:
* `type`: Communication protocol
* `url`: URL of self hosted ELK (optional)
* `host`: Host of logs management service (optional)
* `port`: Port of logs management service (optional)
* `token`: Used by certain vendor for authentication (optional)
* `drain-region`: Used by certain logs management service to identify the region
of their servers (optional)

The parameters used will depend on the chosen provider.

TODO(pc): check if we reference to elk self hosted documentation:
https://doc.scalingo.com/platform/getting-started/getting-started-with-elk

Below, an exhaustive list of examples of additions for each of the supported
vendors

* Scalingo hosted ELK stack:
    ```bash
    scalingo --app my-app log-drains-add --type elk --url https://my-user:123456789abcdef@logstash-app-name.osc-fr1.scalingo.io
    ```

* Datadog:
    ```bash
    scalingo --app my-app log-drains-add --type datadog --token 123456789abcdef --drain-region eu
    ```
    Where
    * `token` parameter is the Datadog API key you can find
    [here](https://app.datadoghq.com/account/settings#api).
    * `region` parameter
    is either `eu` or `us` depending on your Datadog account region.


* Logentries:
    ```bash
    scalingo --app my-app log-drains-add --type logentries --token 123456789abcdef
    ```
    Where `token` parameter is the logentries `LOG-TOKEN`, instructions to get
    it are available on [Logentries
    documentation](https://docs.logentries.com/docs/http-post).

* OVH hosted Graylog:
    ```bash
    scalingo --app my-app log-drains-add --type ovh-graylog --token 123456789abcdef --host tag3.logs.ovh.com
    ```
    Where
    - `token` is the graylog token
    - `host` is the access point provided
    by ovh. Instructions to get the these variables are available on [OVH
    documentation](https://docs.ovh.com/fr/logs-data-platform/quick-start/).

* Papertrail:
    ```bash
    scalingo --app my-app log-drains-add --type papertrail --host logs2.papertrailapp.com --port 12345
    ```
    `host` and `port` are the log host and port number shown under [log
    destination](https://papertrailapp.com/account/destinations).

* Syslog TCP+TLS:
    ```bash
    scalingo --app my-app log-drains-add --type syslog --host custom.logstash.com --port 12345
    ```



### List Log Drains

As you can add multiple log drains by application, you can list them with the
command:
```bash
scalingo --app my-app log-drains
```

Here an example of the output:
```
+--------------------------------------------------------------------+
|                                URL                                 |
+--------------------------------------------------------------------+
| tcp+tls://logs.papertrailapp.com:10333                             |
| ovh://:878e091a-655c-4d40-b4be-72609f8949d0@tag1.logs.ovh.com:6514 |
+--------------------------------------------------------------------+
```

### Delete a Log Drain

To delete a drain, you will have to provide the URL to delete.
You can get it by listing the logs drain of an application ([list
command](https://doc.scalingo.com/platform/app/log-drain#list-log-drains))
```bash
scalingo --app my-app log-drains-remove tcp+tls://logs.papertrailapp.com:10333
```
