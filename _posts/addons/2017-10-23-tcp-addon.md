---
title: Scalingo TCP Addon
modified_at: 2017-10-23 00:00:00
category: addons
tags: tcp load balancer addon custom
---

## Introduction

By default, Scalingo will only let you run web application. Sometimes this is
not enough and you will need to have application that can accept raw TCP
connections.

This addon will let you deploy application that can accept raw TCP connections.

## Setup of the addon

### Provision the addon

First, you need to add the TCP addon to your application. This can be done
through the dashboard on the addons section of your app under the `Network`
category.

### Setup configuration

In order to use the Scalingo TCP addon, you will need to define a new container
type. This can be done in your [`Procfile`](/internals/procfile.html)


Your procfile should look like:
```
web: npm start
tcp: npm run start-tcp
```

### Contact your application

When your application will start, we will define a `PORT` environment variable
in your container. Your application must listen on this port in order to be
accessible from the outside.

Once up and running your application will be accessible at the URL defined by
the `TCP_URL` environment variable. You can find this variable on our dashboard
or by using our CLI:

```bash
scalingo -a my-app env scalingo -a sample-node-mosca env | grep TCP_URL
```

This URL is also accessible on the addon dashboard.

<blockquote class="info"> Your tcp containers might be restarted at any moment by our
scheduler, this will be done with 0 downtime, but the connection to the old
containers will be dropped. So your client must contain a retry policy in case
a connection is dropped.</blockquote>

## Load balancing

If you have multiple `tcp` containers running, Scalingo will distribute
connection to those containers.  Our load balancer will distribute clients
during the TCP handshake. Once a client has been attributed to a server, he
will continue to talk to the same server.

## Rate limiting

Your bandwidth to and from your container is limited. This limit depend on your
addon plan. This limit is in packet per second per container. If a container
get over his limit, we will start dropping excess packet.

Since the MTU is generally equal to 1500 B, you can do the conversion packet/s
to byte/s by multiplying your rate limit by 1500.

So if you have a addon with a limit of 1000 pps with 4 containers running, your
bandwidth will be:

`1000 * 1500 = 1,5 MB/s` for one container

So `1,5 * 4 = 6 MB/s` in total

## Samples

You can find a sample NodeJS application that use this addon to expose a MQTT server built with Mosca [here](https://github.com/Scalingo/sample-node-mosca).
