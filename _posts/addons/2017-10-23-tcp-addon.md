---
title: Scalingo TCP Addon
modified_at: 2017-10-23 00:00:00
category: addons
tags: tcp load balancer addon custom
---

## Introduction

By default, Scalingo will only let you run application that communicate via
HTTP or HTTPS. Sometimes this is not enough and you need to have application
that can accept raw TCP connections.

This addon let you deploy application that can accept raw TCP connections.

## Setup of the Addon

### Provision the Addon

First, you need to add the TCP addon to your application. This can be done
through the dashboard on the addons section of your app under the `Network`
category.

### Setup Configuration

In order to use the Scalingo TCP addon, you need to define a new container
type. This can be done in your [Procfile]({% post_url
internals/2014-12-01-procfile %}).

Your Procfile should look like:

```
web: npm start
tcp: npm run start-tcp
```

### Contact your Application

When your application starts, we define a `PORT` environment variable in your
container. Your application must listen on this port in order to be accessible
from the outside.

Once up and running your application will be accessible at the URL defined by
the `TCP_URL` environment variable. You can find this variable on our dashboard
or by using our CLI:

```bash
scalingo --app my-app env | grep TCP_URL
```

This URL is also accessible on the addon dashboard.

<blockquote class="info">
  Your TCP containers might be restarted at any moment by our scheduler, this
  is done with 0 downtime, but the connections to the old containers are
  dropped. Hence your client must contain a retry policy in case a connection
  is dropped.
</blockquote>

## Load Balancing

If you have multiple `tcp` containers running, Scalingo distributes connections
to those containers. Our load balancer distributes connections during the TCP
handshake. When established, the communication is always routed to the same
server.

## Rate Limiting

Your bandwidth to and from your containers is limited. This limit depends on
your addon plan. This limit is expressed in packet per second per container. If
a container gets over his limit, we will start dropping excess packet.

Since the MTU is generally equal to 1500 bytes, you can do the conversion
packet/s to byte/s by multiplying your rate limit by 1500.

If you have an addon with a limit of 1000 packet/s with 4 containers running,
your bandwidth is:

`1000 * 1500 = 1.5 MB/s` for one container.

`1.5 * 4 = 6 MB/s` for all your containers.

## Samples

You can find a sample Node.js application that use this addon to expose a MQTT
server built with Mosca [here](https://github.com/Scalingo/sample-node-mosca).
